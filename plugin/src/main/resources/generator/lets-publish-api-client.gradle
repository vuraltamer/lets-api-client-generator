tasks.register("publishApiClient", Exec) {
    doFirst {
        def publishProps = [
                clientName:     project.findProperty("clientName") ?: "generator-feign-client",
                clientPath:     project.findProperty("clientPath") ?: projectDir.absolutePath,
                repository:     project.findProperty("repository") ?: "",
                user:           project.findProperty("user") ?: "",
                password:       project.findProperty("password") ?: "",
                allowInsecure:  (project.findProperty("allowInsecure") ?: true).toString()
        ]

        def rootGradlew = "${project.projectDir}/gradlew"
        def clientProjectDir = "${publishProps.clientPath}/.generator/${publishProps.clientName}"
        commandLine = [
                rootGradlew,
                "publish",
                "--project-dir", clientProjectDir,
                "-Prepository=${publishProps.repository}",
                "-Puser=${publishProps.user}",
                "-Ppassword=${publishProps.password}",
                "-PallowInsecure=${publishProps.allowInsecure}"
        ]
    }
}